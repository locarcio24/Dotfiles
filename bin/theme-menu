#!/usr/bin/env bash

# options
minimal="Minimal"
pentest="Pentest"
gooner="Gooner"
md="Marvel Dreamer"
close="Close"

kill_carousel() {
  pgrep -au locarcio bash | grep "carousel" | awk '{print $1}' > pids
  while read -r pid;do
    kill "$pid"
  done <pids
  rm pids
}

run_rofi() {
    echo -e "$minimal\n$pentest\n$gooner\n$md\n$close" | rofi -dmenu -no-custom -i
}

chosen="$(run_rofi)"
case "$chosen" in
    "$minimal")
      pkill waybar
      kill_carousel
      pkill swaybg
      ln -sf /home/locarcio/.config/waybar/minimal/config.jsonc /home/locarcio/.config/waybar/config.jsonc
      ln -sf /home/locarcio/.config/waybar/minimal/style.css /home/locarcio/.config/waybar/style.css
      ln -sf /home/locarcio/.config/kitty/minimal/kitty.conf /home/locarcio/.config/kitty/kitty.conf
      ln -sf /home/locarcio/.config/kitty/minimal/theme.conf /home/locarcio/.config/kitty/theme.conf
      kill -SIGUSR1 $KITTY_PID
      ln -sf /home/locarcio/.config/sway/minimal/appearance /home/locarcio/.config/sway/appearance
      swaymsg reload
      swaybg -i /usr/share/backgrounds/sway/landscape1.png &
      waybar & ;;
    "$pentest")
      pkill waybar
      kill_carousel
      pkill swaybg
      ln -sf /home/locarcio/.config/waybar/pentest/config.jsonc /home/locarcio/.config/waybar/config.jsonc
      ln -sf /home/locarcio/.config/waybar/pentest/style.css /home/locarcio/.config/waybar/style.css
      ln -sf /home/locarcio/.config/kitty/gooner/kitty.conf /home/locarcio/.config/kitty/kitty.conf
      ln -sf /home/locarcio/.config/kitty/gooner/theme.conf /home/locarcio/.config/kitty/theme.conf
      kill -SIGUSR1 $KITTY_PID
      ln -sf /home/locarcio/.config/sway/bNw/appearance /home/locarcio/.config/sway/appearance
      swaymsg reload
      swaybg -i /usr/share/backgrounds/sway/pentest2-wallpaper.png &
      waybar & ;;
    "$gooner")
      pkill waybar
      kill_carousel
      pkill swaybg
      ln -sf /home/locarcio/.config/waybar/gooner/config.jsonc /home/locarcio/.config/waybar/config.jsonc
      ln -sf /home/locarcio/.config/waybar/gooner/style.css /home/locarcio/.config/waybar/style.css
      ln -sf /home/locarcio/.config/kitty/gooner/kitty.conf /home/locarcio/.config/kitty/kitty.conf
      ln -sf /home/locarcio/.config/kitty/gooner/theme.conf /home/locarcio/.config/kitty/theme.conf
      kill -SIGUSR1 $KITTY_PID
      ln -sf /home/locarcio/.config/sway/bNw/appearance /home/locarcio/.config/sway/appearance
      swaymsg reload
      swaybg -i /usr/share/backgrounds/sway/G00N.png &
      waybar & ;;
    "$md")
      pkill waybar
      pkill swaybg
      ln -sf /home/locarcio/.config/waybar/gooner/config.jsonc /home/locarcio/.config/waybar/config.jsonc
      ln -sf /home/locarcio/.config/waybar/gooner/style.css /home/locarcio/.config/waybar/style.css
      ln -sf /home/locarcio/.config/kitty/gooner/kitty.conf /home/locarcio/.config/kitty/kitty.conf
      ln -sf /home/locarcio/.config/kitty/gooner/theme.conf /home/locarcio/.config/kitty/theme.conf
      kill -SIGUSR1 $KITTY_PID
      ln -sf /home/locarcio/.config/sway/wNb/appearance /home/locarcio/.config/sway/appearance
      swaymsg reload
      /home/locarcio/.local/bin/carousel &
      waybar & ;;
esac
